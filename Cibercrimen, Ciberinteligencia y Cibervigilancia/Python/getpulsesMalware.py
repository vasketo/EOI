# -*- encoding: utf-8 -*-

# Get all pulses related to an specific malware.

from OTXv2 import OTXv2

otx = OTXv2("")

pulses = otx.search_pulses("WastedLocker")

for pulse in pulses["results"]:
    pulse_details = otx.get_pulse_details(pulse["id"])
    print ("Fecha de creación:", pulse_details["created"][:19], "Título del pulso:", pulse_details["name"], "Número de indicadores:", len(pulse_details["indicators"]))

    '''
    indicators = otx.get_pulse_indicators(pulse["id"])
    for indicator in indicators:
        print(indicator["type"], indicator["indicator"].replace("htt", "hxx"))
    '''
